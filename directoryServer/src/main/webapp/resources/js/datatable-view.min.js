(function(h){_.createKeyValueObject=function(y,A){var z={};z[y]=A;return z};var g=['<div class="panel-heading">','<div class="progress">','<div class="progress-bar progress-bar-striped active" role="progressbar" aria-valuenow="<%= config.defaultValue %>" aria-valuemin="<%= config.min %>" aria-valuemax="<%= config.max %>" style="width:100%">',"<span><%= config.label %></span>","</div>","</div>","</div>",'<div class="panel-body text-danger"><%= config.errorMessage %></div>'].join("");var m=['<div class="btn-group center-block" role="group" aria-label="navigation">','<button type="button" class="btn btn-default" aria-label="go to first" data-nav-button="first">','<span class="glyphicon glyphicon-step-backward" aria-hidden="true"></span>',"</button>",'<button type="button" class="btn btn-default" aria-label="go to previous" data-nav-button="previous">','<span class="glyphicon glyphicon-triangle-left" aria-hidden="true"></span>',"</button>",'<button type="button" class="btn btn-default" aria-label="go to next" data-nav-button="next">','<span class="glyphicon glyphicon-triangle-right" aria-hidden="true"></span>',"</button>",'<button type="button" class="btn btn-default" aria-label="go to last" data-nav-button="last">','<span class="glyphicon glyphicon-step-forward" aria-hidden="true"></span>',"</button>","</div>"].join("");var l=['<div class="modal-dialog modal-<%= config.modalSize %>">','<div class="modal-content">','<div class="modal-header">','<button type="button" class="close" data-dismiss="modal">','<span aria-hidden="true">&times;</span><span class="sr-only">Close</span>',"</button>",'<h4 class="modal-title"></h4>',"</div>",'<div class="modal-body">','<div class="container-fluid dtview-form-container"></div>',"</div>",'<div class="modal-footer">','<button type="button" class="btn btn-default" data-dismiss="modal">Close</button>','<button type="button" class="btn btn-primary dtview-modal-form-action-button"></button>',"</div>","</div>","</div>"].join("");var i=['<button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown" aria-expanded="false">','<span class="glyphicon glyphicon-eye-close" aria-hidden="true"></span> <span class="caret"></span>',"</button>",'<ul class="dropdown-menu list-inline list-unstyled text-nowrap col-vis-menu" role="menu">','<li<% if(_.has(config,"widthOverride")) { %> style="width:<%= config.widthOverride %>px" <% } %>>',"<h3><u>Column Visibility</u></h3>",'<ul class="list-inline list-unstyled">',"<% for(var i in config.sorted) { %>","<li>",'<div class="checkbox">','<label class="text-nowrap btn btn-sm btn-default">','<input type="checkbox" data-column="<%= config.sorted[i].data %>" ','value="<%= config.sorted[i].index %>"<% if(config.sorted[i].visible) { %> checked="checked"<% } %> />','<span class="text-capitalize"><%= config.sorted[i].title %></span>',"</label>","</div>","</li>","<% } %>","</ul>",'<p><button type="button" class="btn btn-default" data-group-index="-1">reset</button></p>',"</li>","<li>","<h3><u>Visibility Groups</u></h3>","<% for(var i in config.groups) { %>",'<p><button type="button" class="btn btn-default" data-group-index="<%= i %>">','<span class="text-nowrap"><%= config.groups[i].name %></span>',"</button></p>","<% } %>","</li>","</ul>"].join("");var r=['<button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown" aria-expanded="false">','<span class="glyphicon glyphicon-eye-close" aria-hidden="true"></span> <span class="caret"></span>',"</button>",'<ul class="dropdown-menu list-unstyled text-nowrap col-vis-menu" role="menu">','<li<% if(_.has(config,"widthOverride")) { %> style="width:<%= config.widthOverride %>px" <% } %>>',"<h3><u>Column Visibility</u></h3>",'<ul class="list-inline list-unstyled">',"<% for(var i in config.sorted) { %>","<li>",'<div class="checkbox">','<label class="text-nowrap btn btn-sm btn-default">','<input type="checkbox" data-column="<%= config.sorted[i].data %>" ','value="<%= config.sorted[i].index %>"<% if(config.sorted[i].visible) { %> checked="checked"<% } %> />','<span class="text-capitalize"><%= config.sorted[i].title %></span>',"</label>","</div>","</li>","<% } %>","</ul>",'<p><button type="button" class="btn btn-default" data-group-index="-1">reset</button></p>',"</li>","</ul>"].join("");var p=['<table class="table table-condensed table-striped table-bordered dtview-datatable" width="100%"></table>'].join("");var w=function(A,z,y,B){return['<div class="btn-group">','<button type="button" class="btn btn-default btn-info btn-xs dtview-edit-btn" data-row-id="',A,'" data-view-only="false">','<span class="glyphicon glyphicon-cog"></span>',"</button>",'<button type="button" class="btn btn-default btn-danger btn-xs dtview-del-btn">','<span class="glyphicon glyphicon-remove"></span>',"</button>","</div>"].join("")};var x=function(A,z,y,B){return['<div class="center-block text-center">','<a class="dtview-edit-btn" data-row-id="',A,'" data-view-only="true">View</a>',"</div>"].join("")};var e=function(A,z,y,B){return['<div class="btn-group">','<button type="button" class="btn btn-default btn-info btn-xs dtview-edit-btn" data-row-id="',A,'" data-view-only="false">','<span class="glyphicon glyphicon-cog"></span>',"</button>","</div>"].join("")};var c=function(A,y){if(y.ajax.context&&y.ajax.context.model.get("columnFilters")){var z=y.ajax.context.model.get("columnFilters").getFilters();if(z){A.columnfilters=z}A.table=y.ajax.context.model.get("tableData").name}return JSON.stringify(A)};var o=Backbone.View.extend({template:_.template('<input type="hidden" id="<%= forminput.name %>" />',{variable:"forminput"}),type:function(){return"hidden"},name:function(){return this.model.get("name")},get:function(){var z={},y=h.trim(h("input",this.$el).val());z[this.model.get("name")]=y.length>0?y:undefined;return z},set:function(y){h("input",this.$el).val(y);return this},validate:function(){if(this.model.get("required")){return h.trim(h("input",this.$el).val()).length>0?this.get():false}else{return this.get()}},reset:function(){this.render()},initialize:function(y){this.version="1.0.1";this.model=new Backbone.Model(h.extend(true,{name:"hidden-field",inputAttributes:{autocomplete:"off",value:""},required:false},y));this.render()},render:function(){this.$el.empty().append(this.template(this.model.toJSON()));h("input",this.$el).attr(this.model.get("inputAttributes"));if(this.model.get("required")){h("input",this.$el).attr({required:"required"})}return this.$el}});var j=Backbone.View.extend({template:_.template(['<label for="<%= forminput.name %>" class="control-label text-nowrap col-sm-<% if(forminput.orientation==$.fn.DataTableView.LAYOUT_ORIENTATION.VERTICAL) { %>12 text-left-force<% } else { %>2<% } %>">',"<%= forminput.label %>","</label>",'<% if(forminput.orientation==$.fn.DataTableView.LAYOUT_ORIENTATION.HORIZONTAL) { %><div class="col-sm-10"><% } else { %><div class="col-sm-12"><% } %>',"<% if(forminput.textarea) { %>",'<textarea id="<%= forminput.name %>" />',"<% } else { %>",'<input type="text" id="<%= forminput.name %>" />',"<% } %>",'<% if(forminput.feedback && !forminput.textarea) { %><span class="glyphicon form-control-feedback hidden"></span><% } %>',"</div>"].join(""),{variable:"forminput"}),type:function(){return this.model.get("textarea")?"textarea":"text"},name:function(){return this.model.get("name")},get:function(){var z=this.model.get("textarea")?h("textarea",this.$el):h("input",this.$el),A={},y=h.trim(z.val());A[this.model.get("name")]=y.length>0?y:undefined;return A},set:function(z){var y=this.model.get("textarea")?h("textarea",this.$el):h("input",this.$el);y.val(z)},toggleDisabled:function(z){this.model.set("disabled",!z);var y=this.model.get("textarea")?h("textarea",this.$el):h("input",this.$el);if(z){y.removeAttr("disabled")}else{y.attr("disabled","disabled")}},toggleReadonly:function(y){this.model.set("readonly",y);var z=this.model.get("textarea")?h("textarea",this.$el):h("input",this.$el);if(y){z.attr("readonly","readonly")}else{z.removeAttr("readonly")}},validate:function(){this.$el.removeClass("has-success has-error");h("span.form-control-feedback",this.$el).removeClass("glyphicon-ok glyphicon-remove").addClass("hidden");var y=this.model.get("textarea")?h("textarea",this.$el):h("input",this.$el);if(this.model.get("required")){if(h.trim(y.val()).length>0){if(this.model.get("feedback")){this.$el.addClass("has-success");if(!this.model.get("textarea")){h("span.form-control-feedback",this.$el).addClass("glyphicon-ok").removeClass("hidden")}}return this.get()}else{if(this.model.get("feedback")){this.$el.addClass("has-error");if(!this.model.get("textarea")){h("span.form-control-feedback",this.$el).addClass("glyphicon-remove").removeClass("hidden")}}}}else{this.$el.addClass("has-success");return this.get()}},reset:function(){this.render();return this},className:"form-group input-form-control",initialize:function(y){this.version="1.0.1";this.model=new Backbone.Model(h.extend(true,{name:"text-field",label:"Unknown Text Field",inputAttributes:{autocomplete:"off","class":"form-control"},required:false,feedback:true,disabled:false,readonly:false,orientation:h.fn.DataTableView.LAYOUT_ORIENTATION.HORIZONTAL,textarea:false},y));this.$el.addClass("dtview-form-"+this.model.get("name"));if(this.model.get("feedback")){this.$el.addClass("has-feedback")}if(!this.model.get("textarea")){this.model.get("inputAttributes")["class"]=[this.model.get("inputAttributes")["class"],"input-sm"].join(" ");if(!_.has(this.model.get("inputAttributes"),"value")){h.extend(this.model.get("inputAttributes"),{value:""})}if(!_.has(this.model.get("inputAttributes"),"maxlength")){h.extend(this.model.get("inputAttributes"),{maxlength:"45"})}}else{if(!_.has(this.model.get("inputAttributes"),"rows")){h.extend(this.model.get("inputAttributes"),{rows:"2"})}}this.render()},render:function(){this.$el.removeClass("has-success has-error").empty().append(this.template(this.model.toJSON()));var y=this.model.get("textarea")?h("textarea",this.$el):h("input",this.$el);y.attr(this.model.get("inputAttributes"));if(this.model.get("required")){h("label",this.$el).addClass("text-danger");y.attr({required:"required"})}if(this.model.get("disabled")){y.attr("disabled","disabled")}else{if(this.model.get("readonly")){y.attr({readonly:"readonly",disabled:"disabled"})}}return this.$el}});var d=Backbone.View.extend({template:_.template(["<% if(forminput.orientation===$.fn.DataTableView.LAYOUT_ORIENTATION.HORIZONTAL) { %>",'<label class="col-sm-2 control-label text-nowrap"><%= forminput.label %></label>',"<% } else { %>",'<label class="col-sm-12 control-label text-nowrap text-left-force"><%= forminput.label %></label>',"<% } %>",'<div class="btn-group<% if(forminput.buttonGroupSize){ %> <%= forminput.buttonGroupSize %><% } %> col-sm-10" data-toggle="buttons">','<label for="<%= forminput.name %>-true" class="btn btn-primary<% if(forminput.defaultToggled) { %> active<% } %>">','<input type="radio" id="<%= forminput.name %>-true" value="<%= forminput.trueValue %>" <% if(forminput.defaultToggled) { %>checked="checked"<% } %> /> <%= forminput.trueLabel %>',"</label>",'<label for="<%= forminput.name %>-false" class="btn btn-primary<% if(!forminput.defaultToggled) { %> active<% } %>">','<input type="radio" id="<%= forminput.name %>-false" value="<%= forminput.falseValue %>" <% if(!forminput.defaultToggled) { %>checked="checked"<% } %> /> <%= forminput.falseLabel %>',"</label>","</div>"].join(""),{variable:"forminput"}),type:function(){return"toggle"},name:function(){return this.model.get("name")},get:function(){var y={};y[this.model.get("name")]=h("label.active input",this.$el).val();return y},set:function(y){h("label.btn",this.$el).removeClass("active");h(['input[value="',y,'"]'].join(""),this.$el).parent().addClass("active")},toggleDisabled:function(y){this.model.set("disabled",!y);if(y){h("div.btn-group label",this.$el).removeClass("disabled");h("input",this.$el).removeAttr("disabled")}else{h("div.btn-group label",this.$el).addClass("disabled");h("input",this.$el).attr("disabled","disabled")}},toggleReadonly:function(y){this.model.set("readonly",y);if(y){h("div.btn-group label",this.$el).addClass("disabled");h("input",this.$el).attr("disabled","disabled")}else{h("div.btn-group label",this.$el).removeClass("disabled");h("input",this.$el).removeAttr("disabled")}},validate:function(){this.$el.addClass("has-success");return this.get()},reset:function(){this.render();return this},events:{},className:"form-group input-form-control",initialize:function(y){this.version="1.0.0";this.model=new Backbone.Model(h.extend(true,{name:"toggle-field",label:"Unknown Toggle",inputAttributes:{autocomplete:"off"},trueLabel:"Yes",trueValue:1,falseLabel:"No",falseValue:0,defaultToggled:true,disabled:false,readonly:false,buttonGroupSize:null,orientation:h.fn.DataTableView.LAYOUT_ORIENTATION.HORIZONTAL},y));this.$el.addClass("dtview-form-"+this.model.get("name"));this.render()},render:function(){this.$el.empty().removeClass("has-success").append(this.template(this.model.toJSON()));h("input",this.$el).attr(this.model.get("inputAttributes"));if(this.model.get("required")){h("label.control-label",this.$el).addClass("text-danger")}if(this.model.get("disabled")||this.model.get("readonly")){h("div.btn-group label",this.$el).addClass("disabled");h("input",this.$el).attr("disabled","disabled")}return this.$el}});var n=Backbone.View.extend({template:_.template(['<label class="control-label text-nowrap col-sm-<% if(forminput.orientation==$.fn.DataTableView.LAYOUT_ORIENTATION.HORIZONTAL) { %>2<% } else { %>12 text-left-force<% }%>">',"<%= forminput.label %>","</label>","<% if(forminput.orientation==$.fn.DataTableView.LAYOUT_ORIENTATION.HORIZONTAL) { %>",'<div class="btn-group<% if(forminput.buttonGroupSize){ %> <%= forminput.buttonGroupSize %><% } %> col-sm-10" data-toggle="buttons">',"<% } else { %>",'<div class="btn-group-vertical<% if(forminput.buttonGroupSize){ %> <%= forminput.buttonGroupSize %><% } %>" data-toggle="buttons">',"<% } %>","<% for(var i in forminput.buttons) { %>",'<label for="<%= [forminput.name,"-",i].join("") %>" class="btn btn-primary<% if(i==forminput.defaultToggled) { %> active<% } %>">','<input type="radio" id="<%= [forminput.name,"-",i].join("") %>" value="<%= forminput.buttons[i].value %>" <% if(i==forminput.defaultToggled) { %>checked="checked"<% } %> /> <%= forminput.buttons[i].label %>',"</label>","<% } %>","</div>"].join(""),{variable:"forminput"}),type:function(){return"buttonGroup"},name:function(){return this.model.get("name")},get:function(){var y={};y[this.model.get("name")]=h("label.active input",this.$el).val();return y},set:function(y){h("label.btn",this.$el).removeClass("active");h(['input[value="',y[this.model.get("valueKey")],'"]'].join(""),this.$el).parent().addClass("active")},toggleDisabled:function(y){this.model.set("disabled",!y);if(y){h("div.btn-group label",this.$el).removeClass("disabled");h("input",this.$el).removeAttr("disabled")}else{h("div.btn-group label",this.$el).addClass("disabled");h("input",this.$el).attr("disabled","disabled")}},toggleReadonly:function(y){this.model.set("readonly",y);if(y){h("div.btn-group label",this.$el).addClass("disabled");h("input",this.$el).attr("disabled","disabled")}else{h("div.btn-group label",this.$el).removeClass("disabled");h("input",this.$el).removeAttr("disabled")}},validate:function(){this.$el.addClass("has-success");return this.get()},reset:function(){this.render();return this},events:{},className:"form-group input-form-control",initialize:function(y){this.version="1.0.1";this.model=new Backbone.Model(h.extend(true,{name:"button-group-field",label:"Unknown Button Group",valueKey:"",inputAttributes:{autocomplete:"off"},buttons:[],defaultToggled:0,disabled:false,readonly:false,buttonGroupSize:null,orientation:h.fn.DataTableView.LAYOUT_ORIENTATION.HORIZONTAL},y));this.$el.addClass("dtview-form-"+this.model.get("name"));this.render()},render:function(){this.$el.empty().removeClass("has-success").append(this.template(this.model.toJSON()));h("input",this.$el).attr(this.model.get("inputAttributes"));if(this.model.get("required")){h("label.control-label",this.$el).addClass("text-danger")}if(this.model.get("disabled")||this.model.get("readonly")){h("div.btn-group label",this.$el).addClass("disabled");h("input",this.$el).attr("disabled","disabled")}return this.$el}});var u=Backbone.View.extend({template:_.template(['<label for="<%= forminput.name %>" class="control-label text-nowrap col-sm-<% if(forminput.orientation==$.fn.DataTableView.LAYOUT_ORIENTATION.VERTICAL) { %>12 text-left-force<% } else { %>2<% } %>">',"<%= forminput.label %>","</label>",'<div class="col-xs-<%= forminput.selectSize %>">','<select class="form-control">',"<% for(var i in forminput.options) { %>",'<option value="<%= forminput.options[i].value %>"<% if(i===forminput.defaultSelected) { %> selected="selected"<% } %>">',"<%= forminput.options[i].label %>","</option>","<% } %>","</select>","</div>"].join(""),{variable:"forminput"}),type:function(){return"select"},name:function(){return this.model.get("name")},get:function(){var y={};y[this.model.get("name")]=h("select",this.$el).val();return y},set:function(y){h("select",this.$el).val(y[this.model.get("valueKey")])},toggleDisabled:function(y){this.model.set("disabled",!y);if(y){h("select",this.$el).removeAttr("disabled")}else{h("select",this.$el).attr("disabled","disabled")}},toggleReadonly:function(y){this.model.set("readonly",y);if(y){h("select",this.$el).attr("disabled","disabled")}else{h("select",this.$el).removeAttr("disabled")}},validate:function(){this.$el.addClass("has-success");return this.get()},reset:function(){this.render();return this},className:"form-group input-form-control",initialize:function(y){this.version="1.0.1";this.model=new Backbone.Model(h.extend(true,{name:"select-field",label:"Unknown Select",valueKey:"",required:false,disabled:false,readonly:false,inputAttributes:{autocomplete:"off"},options:[],defaultSelected:0,selectSize:6,orientation:h.fn.DataTableView.LAYOUT_ORIENTATION.HORIZONTAL},y));this.$el.addClass("dtview-form-"+this.model.get("name"));if(!_.isFinite(this.model.get("selectSize"))||this.model.get("selectSize")<1||this.model.get("selectSize")>12){this.model.set("selectSize",6)}this.render()},render:function(){this.$el.empty().removeClass("has-success").append(this.template(this.model.toJSON()));h("select",this.$el).attr(this.model.get("inputAttributes"));if(this.model.get("required")){h("label",this.$el).addClass("text-danger");h("select",this.$el).attr({required:"required"})}if(this.model.get("disabled")||this.model.get("readonly")){h("select",this.$el).attr("disabled","disabled")}return this.$el}});var t=Backbone.View.extend({template:_.template(['<label for="<%= forminput.name %>" class="control-label text-nowrap col-sm-<% if(forminput.orientation==$.fn.DataTableView.LAYOUT_ORIENTATION.VERTICAL) { %>12 text-left-force<% } else { %>2<% } %>">',"<%= forminput.label %>","</label>",'<% if(forminput.orientation===$.fn.DataTableView.LAYOUT_ORIENTATION.VERTICAL) { %><div class="col-sm-12"><% } else { %><div class="col-sm-10"><% } %>','<div id="spinbox-formcontrol-<%= forminput.name %>" class="spinbox" data-initialize="spinbox">','<input type="text" id="<%= forminput.name %>" />','<div class="spinbox-buttons btn-group btn-group-vertical">','<button type="button" class="btn btn-default spinbox-up btn-xs">','<span class="glyphicon glyphicon-chevron-up"></span><span class="sr-only">Increase</span>',"</button>",'<button type="button" class="btn btn-default spinbox-down btn-xs">','<span class="glyphicon glyphicon-chevron-down"></span><span class="sr-only">Decrease</span>',"</button>","</div>","</div>","</div>"].join(""),{variable:"forminput"}),type:function(){return"number"},name:function(){return this.model.get("name")},get:function(){var y={},z=h("div.spinbox",this.$el).spinbox("value");y[this.model.get("name")]=_.isFinite(z)?z*1:undefined;return y},set:function(y){if(_.isFinite(y)){h("div.spinbox",this.$el).spinbox("value",y)}},toggleDisabled:function(y){this.model.set("disabled",!y);if(y){h("div.spinbox",this.$el).spinbox("enable")}else{h("div.spinbox",this.$el).spinbox("disable")}},toggleReadonly:function(y){this.model.set("readonly",y);if(y){h("div.spinbox",this.$el).spinbox("disable")}else{h("div.spinbox",this.$el).spinbox("enable")}},validate:function(){this.$el.removeClass("has-success has-error");var y=h("div.spinbox",this.$el).spinbox("value");if(this.model.get("required")){if(_.isFinite(y)){if(this.model.get("feedback")){this.$el.addClass("has-success")}return this.get()}else{if(this.model.get("feedback")){this.$el.addClass("has-error")}}}else{this.$el.addClass("has-success");return this.get()}},reset:function(){this.render();return this},className:"form-group input-form-control fuelux",initialize:function(y){this.version="1.0.5";this.model=new Backbone.Model(h.extend(true,{name:"number-field",label:"Unknown Number Field",inputAttributes:{autocomplete:"off","class":"form-control input-mini spinbox-input"},required:false,feedback:true,disabled:false,readonly:false,orientation:h.fn.DataTableView.LAYOUT_ORIENTATION.HORIZONTAL,spinboxConfig:{value:1,min:1,max:999,step:1,hold:true,speed:"medium",disabled:false,units:[]}},y));this.$el.addClass("dtview-form-"+this.model.get("name"));if(this.model.get("feedback")){this.$el.addClass("has-feedback")}h("input",this.$el).off("fu.data-api");this.render()},render:function(){this.$el.empty().removeClass("has-success has-error").removeClass("has-success has-error").append(this.template(this.model.toJSON()));h("input",this.$el).attr(this.model.get("inputAttributes"));if(this.model.get("required")){h("label",this.$el).addClass("text-danger");h("input",this.$el).attr({required:"required"})}if(this.model.get("disabled")){h("div.spinbox",this.$el).spinbox("disable")}else{if(this.model.get("readonly")){h("div.spinbox",this.$el).spinbox("disable")}}h(["spinbox-formcontrol-",this.model.get("name")].join(""),this.$el).spinbox(this.model.get("spinboxConfig"));return this.$el}});var b=Backbone.View.extend({template:_.template(['<label for="<%= forminput.name %>" class="control-label text-nowrap col-sm-<% if(forminput.orientation==$.fn.DataTableView.LAYOUT_ORIENTATION.VERTICAL) { %>12 text-left-force<% } else { %>2<% } %>">',"<%= forminput.label %>","</label>",'<div class="col-sm-<%= forminput.inputColumnSize %>">','<input type="text" id="<%= forminput.name %>" />','<% if(forminput.feedback) { %><span class="glyphicon form-control-feedback hidden"></span><% } %>',"</div>"].join(""),{variable:"forminput"}),type:function(){return this.model.get("timestamp")?"timestamp":"datepicker"},name:function(){return this.model.get("name")},get:function(){var y={};var z=h("input",this.$el).datepicker("getUTCDate");if(z){y[this.model.get("name")]=this.model.get("timestamp")?z.valueOf():z}else{y[this.model.get("name")]=undefined}return y},set:function(y){if(y){var z;if(_.isFinite(y)){z=moment.utc(y).toDate()}else{if(_.isDate(y)){z=moment.utc([y.getUTCFullYear(),y.getUTCMonth(),y.getUTCDate()]).toDate()}}h("input",this.$el).datepicker("setUTCDate",z)}},toggleDisabled:function(y){this.model.set("disabled",!y);if(y){h("input",this.$el).removeAttr("disabled")}else{h("input",this.$el).attr("disabled","disabled")}},toggleReadonly:function(y){this.model.set("readonly",y);if(y){h("input",this.$el).attr("readonly","readonly")}else{h("input",this.$el).removeAttr("readonly")}},validate:function(){if(!this.model.get("readonly")){this.$el.removeClass("has-success has-error");h("span.form-control-feedback",this.$el).removeClass("glyphicon-ok glyphicon-remove").addClass("hidden");var y=h("input",this.$el).datepicker("getUTCDate");if(this.model.get("required")){if(y){if(this.model.get("feedback")){this.$el.addClass("has-success");h("span.form-control-feedback",this.$el).addClass("glyphicon-ok").removeClass("hidden")}return this.get()}else{if(this.model.get("feedback")){this.$el.addClass("has-error");h("span.form-control-feedback",this.$el).addClass("glyphicon-remove").removeClass("hidden")}}}else{this.$el.addClass("has-success");return this.get()}}},reset:function(){this.render();return this},events:{},className:"form-group input-form-control",initialize:function(y){this.version="1.0.1";this.model=new Backbone.Model(h.extend(true,{name:"datepicker-field",label:"Unknown Datepicker Field",inputAttributes:{autocomplete:"off","class":"form-control",value:""},required:false,feedback:true,disabled:false,readonly:false,timestamp:false,orientation:h.fn.DataTableView.LAYOUT_ORIENTATION.HORIZONTAL,inputColumnSize:4,datepickerConfig:{autoclose:true,format:"m/d/yyyy"}},y));this.$el.addClass("dtview-form-"+this.model.get("name"));if(this.model.get("feedback")){this.$el.addClass("has-feedback")}if(!_.isFinite(this.model.get("inputColumnSize"))||this.model.get("inputColumnSize")<1||this.model.get("inputColumnSize")>12){this.model.set("inputColumnSize",4)}if(this.model.get("events")){for(var z in this.model.get("events")){this.on(z,this.model.get("events")[z])}}this.render()},render:function(){this.$el.empty().removeClass("has-success has-error").append(this.template(this.model.toJSON()));h("input",this.$el).attr(this.model.get("inputAttributes"));if(this.model.get("required")){h("label",this.$el).addClass("text-danger");h("input",this.$el).attr({required:"required"})}if(this.model.get("disabled")){h("input",this.$el).attr("disabled","disabled")}else{if(this.model.get("readonly")){h("input",this.$el).attr({readonly:"readonly",disabled:"disabled"})}}h("input",this.$el).datepicker(this.model.get("datepickerConfig"));return this.$el}});var f=Backbone.View.extend({template:_.template(['<label for="<%= forminput.name %>" class="control-label text-nowrap col-sm-<% if(forminput.orientation==$.fn.DataTableView.LAYOUT_ORIENTATION.VERTICAL) { %>12 text-left-force<% } else { %>2<% } %>">',"<%= forminput.label %>","</label>",'<% if(forminput.orientation==$.fn.DataTableView.LAYOUT_ORIENTATION.HORIZONTAL) { %><div class="col-sm-10"><% } else { %><div class="col-sm-12"><% } %>','<div class="tt-dropdown-menu form-group input-form-control">','<div class="input-group">','<div class="tt-dropdown-menu">','<input type="text" id="<%= forminput.name %>" />',"</div>",'<span class="input-group-btn">','<button type="button" class="btn btn-default btn-danger" disabled="disabled" style="height:34px;margin-top:-5px">','<span class="glyphicon glyphicon-remove"></span><span class="sr-only">reset</span>',"</button>","</span>","</div>","</div>","</div>"].join(""),{variable:"forminput"}),displayItem:function(y){return typeof(this.model.get("displayer"))==="string"?y[this.model.get("displayer")]:this.model.get("displayer")(y)},type:function(){return"typeahead"},name:function(){return this.model.get("name")},get:function(){var y={};y[this.model.get("name")]=this.model.get("selectedItem");return y},set:function(y){this.model.set("selectedItem",y);h("input",this.$el).typeahead("val",this.displayItem(y))},toggleDisabled:function(y){this.model.set("disabled",!y);if(y){h("input, button",this.$el).removeAttr("disabled")}else{h("input, button",this.$el).attr("disabled","disabled")}},toggleReadonly:function(y){this.model.set("readonly",y);if(y){h("input, button",this.$el).attr("readonly","readonly")}else{h("input, button",this.$el).removeAttr("readonly")}},validate:function(){this.$el.removeClass("has-success has-error");if(this.model.get("required")){if(h.trim(h("input",this.$el).val()).length>0){if(this.model.get("feedback")){this.$el.addClass("has-success")}return this.get()}else{if(this.model.get("feedback")){this.$el.addClass("has-error")}}}else{this.$el.addClass("has-success");return this.get()}},reset:function(){this.render();return this},events:{"typeahead:select":function(z,y){this.model.set("selectedItem",y)},"typeahead:autocomplete":function(z,y){this.model.set("selectedItem",y)},"typeahead:change":function(y){if(this.model.get("selectedItem")){h("input",this.$el).typeahead("val",this.displayItem(this.model.get("selectedItem")))}},"typeahead:idle":function(y){if(this.model.get("selectedItem")){h("input",this.$el).typeahead("val",this.displayItem(this.model.get("selectedItem")))}},"click button":function(y){this.reset()}},className:"form-group input-form-control",initialize:function(y){this.version="1.0.1";this.model=new Backbone.Model(h.extend(true,{name:"typeahead-field",label:"Unknown Typeahead Field",extraClass:null,inputAttributes:{autocomplete:"off","data-provide":"typeahead","class":"form-control typeahead",value:""},required:false,feedback:true,disabled:false,readonly:false,orientation:h.fn.DataTableView.LAYOUT_ORIENTATION.HORIZONTAL,typeaheadConfigOptions:{highlight:false,hint:false,minLength:3}},y,{selectedItem:undefined,displayer:y.datasets.displayKey}));this.$el.addClass("dtview-form-"+this.model.get("name"));if(this.model.get("feedback")){this.$el.addClass("has-feedback")}this.model.on("change:selectedItem",function(A,B,z){if(!this.model.get("disabled")&&!this.model.get("readonly")){if(B&&B.id!==1){h("button",this.$el).removeAttr("disabled")}else{h("button",this.$el).attr("disabled","disabled")}}},this);if(this.model.get("extraClass")){this.$el.addClass(this.model.get("extraClass"))}this.render()},render:function(){this.$el.empty().removeClass("has-success has-error").append(this.template(this.model.toJSON()));h("input",this.$el).attr(this.model.get("inputAttributes"));if(this.model.get("required")){h("label",this.$el).addClass("text-danger");h("input",this.$el).attr({required:"required"})}if(this.model.get("disabled")){h("input, button",this.$el).attr("disabled","disabled")}else{if(this.model.get("readonly")){h("input, button",this.$el).attr({readonly:"readonly",disabled:"disabled"})}}h("input.typeahead",this.$el).typeahead(this.model.get("typeaheadConfigOptions"),this.model.get("datasets"));this.model.set("selectedItem",undefined);return this.$el}});var k=Backbone.View.extend({template:_.template(g,{variable:"config"}),toggle:function(y){this.$el.toggle(y);return this},updateLabel:function(y){h("div.progress-bar span",this.$el).empty().append(y);return this},updateProgress:function(z){if(_.isFinite(z)&&z<=this.model.get("max")){var y=[z,"%"].join("");h("div.progress-bar",this.$el).attr({"aria-valuenow":z,style:["width",y].join(":")});h("div.progress-bar span").empty().html(y)}return this},updateMessage:function(y){h("div.panel-body",this.$el).empty().append(y);return this},reset:function(){this.render();return this},events:{},className:"panel action-progress-panel",initialize:function(y){this.version="1.0.1";this.model=new Backbone.Model({progressAttributes:{"class":"progress-bar progress-bar-striped active",role:"progressbar",style:"width:100%"},label:"",defaultValue:100,min:0,max:100,errorMessage:""});this.render()},render:function(){this.$el.empty().append(this.template(this.model.toJSON()));return this.$el}});var a=Backbone.View.extend({template_nogroups:_.template(r,{variable:"config"}),template_groups:_.template(i,{variable:"config"}),events:{"click ul.dropdown-menu input, ul.dropdown-menu label":function(y){y.stopPropagation()},"change ul.dropdown-menu input":function(y){this.trigger("columnVisibilityControl.column.change",y.currentTarget.value*1,y.currentTarget.checked);y.stopPropagation();return false},"click ul.dropdown-menu button":function(z){var y=h(z.currentTarget).data("group-index")*1,A=y<0?this.model.get("default"):this.model.get("groups")[h(z.currentTarget).data("group-index")].columns;h("div.checkbox input",this.$el).each(function(B){this.checked=(_.indexOf(A,h(this).data("column"))>-1)});this.trigger("columnVisibilityControl.group.change",_.pluck(_.pick(this.model.get("columns"),A),"index"));z.stopPropagation()}},className:"btn-group",initialize:function(z){this.version="1.0.1";var y=h.extend(true,{columns:{},"default":[],groups:[]},_.omit(z,["class"]),{sorted:_.sortBy(z.columns,"index")});if(_.has(z,"class")){this.$el.addClass(z["class"])}if(y["default"].length<1){y["default"]=_.pluck(_.filter(y.sorted,function(A){return(_.has(A,"visible")&&A.visible)}),"data")}this.model=new Backbone.Model(y)},render:function(){return this.$el.append(this.model.get("groups").length?this.template_groups(this.model.toJSON()):this.template_nogroups(this.model.toJSON()))}});var q=Backbone.View.extend({show:function(){this.$el.show();return this},hide:function(){this.$el.hide();return this},toggle:function(y){this.$el.toggle(y);return this},isVisible:function(){return this.$el.is(":visible")},enable:function(){h("button",this.$el).removeAttr("disabled")},disable:function(){h("button",this.$el).attr("disabled","disabled")},update:function(y){this.model.set("currentIndex",y)},template:_.template(m),events:{"click button":function(y){switch(h(y.currentTarget).data("nav-button")){case"first":this.model.set("currentIndex",0);break;case"previous":this.model.set("currentIndex",this.model.get("currentIndex")-1);break;case"next":this.model.set("currentIndex",this.model.get("currentIndex")+1);break;case"last":this.model.set("currentIndex",this.model.get("length")-1);break}this.$el.trigger("formnav.nav.click",[this,this.model.get("currentIndex")])}},className:"datatable-page-form-navigation-group",initialize:function(y){this.version="1.0.1";this.model=new Backbone.Model({currentIndex:0,length:0});this.model.on("change",this.render,this)},render:function(z,y){this.$el.empty().append(this.template({}));if(this.model.get("length")){if(this.model.get("currentIndex")==0){h('button[data-nav-button="first"]',this.$el).attr("disabled","disabled");h('button[data-nav-button="previous"]',this.$el).attr("disabled","disabled")}if(this.model.get("currentIndex")==(this.model.get("length")-1)){h('button[data-nav-button="last"]',this.$el).attr("disabled","disabled");h('button[data-nav-button="next"]',this.$el).attr("disabled","disabled")}}else{h("button",this.$el).attr("disabled","disabled")}}});var s=Backbone.View.extend({template:_.template(l,{variable:"config"}),get:function(y){return this.model.get(y)},show:function(){this.$el.modal("show");return this},hide:function(){this.$el.modal("hide");return this},displaysNavigation:function(){return this.model.get("showNavigation")},updateTitle:function(y){h("h4.modal-title",this.$el).html(y);return this},getActionType:function(){return this.model.get("actionType")},setActionType:function(y){this.model.set("actionType",y);return this},updateActionButtonTitle:function(y){h("button.dtview-modal-form-action-button",this.$el).html(y);return this},toggleNavigation:function(y){if(this.model.get("showNavigation")){this.model.get("headerNav").toggle(y);this.model.get("footerNav").toggle(y)}return this},toggleActionPanel:function(A,y,z){this.model.get("actionPanel").toggle(A);if(A){this.toggleForm(false);if(this.model.get("showNavigation")){if(this.model.get("headerNav").isVisible()){this.model.get("headerNav").disable()}if(this.model.get("footerNav").isVisible()){this.model.get("footerNav").disable()}}if(y){this.model.get("actionPanel").updateLabel(y)}else{this.model.get("actionPanel").updateLabel("")}if(z){this.model.get("actionPanel").updateMessage(z)}else{this.model.get("actionPanel").updateMessage("")}h("div.modal-footer button.dtview-modal-form-action-button",this.$el).hide();h("div.modal-content",this.$el)[0].scrollIntoView({behavior:"smooth",block:"start"})}return this},updateActionLabel:function(y){this.model.get("actionPanel").updateLabel(y);return this},updateActionMessage:function(y){this.model.get("actionPanel").updateMessage(y);return this},toggleForm:function(y){h("div.dtview-form-container",this.$el).toggle(y);if(y){if(this.model.get("showNavigation")){if(this.model.get("headerNav").isVisible()){this.model.get("headerNav").enable()}if(this.model.get("footerNav").isVisible()){this.model.get("footerNav").enable()}}h("div.modal-footer button.dtview-modal-form-action-button",this.$el).show();this.toggleActionPanel(false)}return this},updateNav:function(y,z){if(this.model.get("showNavigation")){this.model.get("headerNav").show().model.set({currentIndex:y,length:z});this.model.get("footerNav").show().model.set({currentIndex:y,length:z})}return this},events:{"formnav.nav.click":function(z,A,y){if(A.cid==this.model.get("headerNav").cid){this.model.get("footerNav").update(y)}else{if(A.cid==this.model.get("footerNav").cid){this.model.get("headerNav").update(y)}}this.$el.trigger("modalForm.nav.change",[this,y])},"click button.dtview-modal-form-action-button":function(y){this.$el.trigger("modalForm.action.click")},"click div.action-progress-panel div.panel-body button":function(y){},"shown.bs.modal":function(y){this.model.set("visible",true);this.$el.trigger("modalForm.visibility.change",[this.model.get("visible")])},"hidden.bs.modal":function(y){this.toggleForm(true);this.toggleActionPanel(false);this.model.set("visible",false);this.$el.trigger("modalForm.visibility.change",[this.model.get("visible")])}},className:"modal fade edit-dtview-modal",initialize:function(y){this.version="1.0.1";var z={headerNav:new q({}),footerNav:new q({}),actionPanel:new k({}),visible:false,actionType:h.fn.DataTableView.ACTION_TYPES.NOTHING};this.model=new Backbone.Model(h.extend(true,{showNavigation:true,showProgressPanel:false,bodyContent:null,modalSize:"xl",modalConfig:{backdrop:"static",keyboard:false,show:false},formAttributes:{"class":"form-horizontal","accept-charset":"utf-8",role:"form"}},y,z));this.render()},render:function(){this.$el.empty().append(this.template(this.model.toJSON()));h("div.modal-body",this.$el).prepend(this.model.get("actionPanel").$el);h("div.modal-header",this.$el).append(this.model.get("headerNav").$el);h("div.modal-footer",this.$el).prepend(this.model.get("footerNav").$el);this.toggleActionPanel(this.model.get("showProgressPanel")).toggleNavigation(this.model.get("showNavigation"));h("div.dtview-form-container",this.$el).empty().append(h("<form />").attr(this.model.get("formAttributes")));if(this.model.get("bodyContent")){h("div.dtview-form-container form",this.$el).empty().append(this.model.get("bodyContent"))}if(_.indexOf([h.fn.DataTableView.MODES.DISABLED,h.fn.DataTableView.MODES.READ_ONLY,h.fn.DataTableView.MODES.DATATABLE_ONLY],this.model.get("mode"))>-1){h("button.dtview-modal-form-action-button",this.$el).hide()}this.$el.modal(this.model.get("modalConfig"));return this.$el}});var v=Backbone.View.extend({template:_.template(p),setFormInputs:function(B,A){var z,y,C;for(y in this.model.get("formInputs")){C=this.model.get("formInputs")[y];z=_.findWhere(this.get("tableData").columns,{data:C.model.get("name")});if(A){C.reset()}if(_.has(B,C.model.get("name"))){if(z&&_.has(z,"setFields")&&_.isArray(z.setFields)){C.set.apply(C,_.values(_.pick(B,z.setFields)))}else{C.set(B[C.model.get("name")])}}}},get:function(y){return this.model.get(y)},validate:function(){if(this.get("modalForm").get("visible")){var z={},C,D,A,B;for(B in this.get("formInputs")){if(_.indexOf(["select","buttonGroup"],this.get("formInputs")[B].type())>-1){C=_.findWhere(this.get("tableData").columns,{data:this.get("formInputs")[B].name()});D=_.isFinite(C.datasource[0][C.valueKey])?this.get("formInputs")[B].validate()[C.data]*1:this.get("formInputs")[B].validate()[C.data];var y={};y[C.valueKey]=D;A=_.findWhere(C.datasource,y);if(A){h.extend(z,_.createKeyValueObject(this.get("formInputs")[B].name(),A))}}else{h.extend(z,this.get("formInputs")[B].validate())}}return z}else{return false}},versions:function(){var z,C=_.map(this.get("formInputs"),function(D){return{type:D.model.get("type"),version:D.version}}),A=_.groupBy(C,"type"),B=_.keys(A),y={};for(z in B){y[B[z]]=A[B[z]][0].version}return{DataTableView:this.version,DataTable:h.fn.DataTable.version,FixedColumns:h.fn.dataTable.FixedColumns.version,ColumnVisibilityControl:this.get("columnVisibilityControl").version,ModalForm:this.get("modalForm").version,"Input Controls":y,ColumnFilters:this.get("columnFilters").versions()}},events:{"init.dt":function(B,z,y){this.$el.prepend(this.model.get("columnFilters").$el);var A;if(!this.model.get("url")){this.model.set("datatable",h(B.target).DataTable().table())}else{A=h(this.model.get("datatable").table().container())}A=h(this.model.get("datatable").table().container());h("div.refresh-datatable-btn-container",this.$el).append(['<button type="button" class="btn btn-default" title="refresh data">','<span class="glyphicon glyphicon-refresh"></span>',"</button>"].join(""));this.model.set("columnVisibilityControl",new a({"class":"pull-left",widthOverride:430,columns:_.object(_.rest(this.model.get("datatable").columns().dataSrc().toArray(),1),_.map(_.filter(z.aoColumns,function(C){return C.data!==null&&(!_.has(C,"cfexclude")||(_.has(C,"cfexclude")&&!C.cfexclude))}),function(C){return{title:C.sTitle,visible:C.bVisible,index:C.idx*1,data:C.data}})),groups:this.model.get("tableData").groups}));h(".column-visibility-container",A).append(this.model.get("columnVisibilityControl").render());this.listenTo(this.model.get("columnVisibilityControl"),"columnVisibilityControl.column.change",function(D,C){this.model.get("datatable").column(D).visible(C,false);this.model.get("datatable").draw(false).columns.adjust();this.trigger("datatableView.columnVisibility.column.change",this.model.get("datatable").columns(":visible:not(.action-column)").indexes().toArray(),this.model.get("datatable").columns(":visible:not(.action-column)").dataSrc().toArray());this.$el.trigger("datatableView.columnVisibility.column.change",[this.model.get("datatable").columns(":visible:not(.action-column)").indexes().toArray(),this.model.get("datatable").columns(":visible:not(.action-column)").dataSrc().toArray()])});this.listenTo(this.model.get("columnVisibilityControl"),"columnVisibilityControl.group.change",function(C){this.model.get("datatable").columns(":not(.action-column)").visible(false,false);this.model.get("datatable").columns(C).visible(true,false);this.model.get("datatable").draw(false).columns.adjust();this.trigger("datatableView.columnVisibility.column.change",C,this.model.get("datatable").columns(":visible:not(.action-column)").dataSrc().toArray());this.$el.trigger("datatableView.columnVisibility.column.change",[C,this.model.get("datatable").columns(":visible:not(.action-column)").dataSrc().toArray()])});if(_.indexOf([h.fn.DataTableView.MODES.MODIFY_ONLY,h.fn.DataTableView.MODES.MODIFY],this.model.get("mode"))>-1){h("div.add-button-container",this.$el).append(['<button type="button" class="btn btn-success pull-left">Add ',"</button>"].join(this.model.get("tableData").label))}if(this.model.get("extraUI")){h("div.custom-ui",A).append(this.model.get("extraUI"))}this.trigger("datatableview.init");this.$el.trigger("datatableview.init")},"xhr.dt":function(A,z,y,B){if(!y){console.log(B.getAllResponseHeaders());this.trigger("datatableview.ajax.error",B,y);this.$el.trigger("datatableview.ajax.error",[B,y])}},"click div.refresh-datatable-btn-container":function(y){this.model.get("datatable").ajax.reload(null,false)},"click div.add-button-container button":function(z){for(var y in this.model.get("formInputs")){this.model.get("formInputs")[y].reset()}this.model.get("modalForm").updateTitle("Create "+this.model.get("tableData").label).updateActionButtonTitle("Create").setActionType(h.fn.DataTableView.ACTION_TYPES.CREATE).toggleNavigation(false).show()},"click .dtview-edit-btn":function(D){var H=h(D.currentTarget).parent().parent().parent()[0],y=this.get("fc").fnGetPosition(H),A=this.get("datatable").rows({page:"current"}).indexes().toArray(),F=this.get("datatable").row(y,{page:"current"}).data(),E=_.indexOf(A,y),G,C=h(D.currentTarget).data("view-only"),z=[C?"View":"Edit",this.model.get("tableData").label].join(" "),B=C?h.fn.DataTableView.ACTION_TYPES.NOTHING:h.fn.DataTableView.ACTION_TYPES.EDIT;if(F){this.model.get("modalForm").updateTitle(z).updateActionButtonTitle("Save").setActionType(B).updateNav(E,A.length).show();this.setFormInputs(F)}},"modalForm.nav.change":function(C,B,y){var z=this.get("datatable").rows({page:"current"}).indexes().toArray();B.updateNav(y,z.length);var D=this.get("datatable").row(z[y],{page:"current"}).data(),A;this.setFormInputs(D,true)},"click button.dtview-del-btn":function(z){var y=h(z.currentTarget).parent().parent().parent()[0],B=this.get("fc").fnGetPosition(y),A=this.get("datatable").row(B,{page:"current"}).data();if(this.get("webServiceUrl")){this.get("modalForm").toggleActionPanel(true,"removing").show();h.ajax({context:this,url:[this.get("webServiceUrl"),A[this.get("tableData").primaryKeyColumn]].join("/"),method:"DELETE"}).fail(function(C,E,D){this.get("modalForm").updateActionMessage(E);this.trigger("datatableview.ajax.error",C,null);this.$el.trigger("datatableview.ajax.error",[C,null])}).done(function(D,E,C){this.get("modalForm").updateActionLabel("removing ... done");this.get("datatable").ajax.reload(null,false);this.get("modalForm").hide().toggleActionPanel(false)})}this.trigger("datatableview.row.delete",A);this.$el.trigger("datatableview.row.delete",[A])},"modalForm.action.click":function(A){var z=this.validate(),C=_.pluck(_.filter(this.get("tableData").columns,function(D){return D.required==true}),"data"),y=_.difference(C,_.keys(z)),B;if(z&&y.length==0){this.get("modalForm").toggleActionPanel(true,"saving");if(this.get("webServiceUrl")){switch(this.get("modalForm").getActionType()){case h.fn.DataTableView.ACTION_TYPES.EDIT:if(this.model.get("url")){h.ajax({context:this,contentType:"application/json",dataType:"json",url:[this.get("webServiceUrl"),z[this.get("tableData").primaryKeyColumn]].join("/"),method:"PUT",data:JSON.stringify(z),processData:false}).fail(function(D,F,E){this.get("modalForm").updateActionMessage(F);this.trigger("datatableview.ajax.error",D,null);this.$el.trigger("datatableview.ajax.error",[D,null])}).done(function(E,F,D){this.get("modalForm").updateActionLabel("saving ... done");this.get("datatable").ajax.reload(null,false);this.get("modalForm").hide().toggleActionPanel(false)})}else{this.model.get("datatable")}break;case h.fn.DataTableView.ACTION_TYPES.CREATE:if(this.model.get("url")){h.ajax({context:this,contentType:"application/json",dataType:"json",url:this.get("webServiceUrl"),method:"POST",data:JSON.stringify(z),processData:false}).fail(function(D,F,E){this.get("modalForm").updateActionMessage(F);this.trigger("datatableview.ajax.error",D,null);this.$el.trigger("datatableview.ajax.error",[D,null])}).done(function(E,F,D){this.get("modalForm").updateActionLabel("saving ... done");this.get("datatable").ajax.reload(null,false);this.get("modalForm").hide().toggleActionPanel(false)})}else{this.get("datatable").rows().add(z).draw();this.get("modalForm").hide().toggleActionPanel(false)}break}}this.trigger("datatableview.validate.pass",z);this.$el.trigger("datatableview.validate.pass",[z])}else{B=["required fields did not validate:",_.pluck(_.filter(this.get("tableData").columns,function(D){return _.contains(y,D.data)}),"title")].join(" ");this.trigger("datatableview.validate.fail",z,y,B);this.$el.trigger("datatableview.validate.fail",[z,y,B])}},"modalForm.visibility.change":function(z,A){if(!A){var y;for(y in this.get("formInputs")){this.get("formInputs")[y].reset()}}}},initialize:function(z){this.version="1.0.1";if(z.url){z.datatableConfig.ajax.context=this}this.model=new Backbone.Model(z);var D=this.get("formInputs").length?h.map(this.get("formInputs"),function(F,E){return F.$el}):null,A,C,y=_.indexOf([h.fn.DataTableView.MODES.DISABLED,h.fn.DataTableView.MODES.READ_ONLY,h.fn.DataTableView.MODES.DATATABLE_ONLY],this.get("mode"))>-1,B=this.get("modalFormConfig");if(this.get("formTemplate")){D=this.get("formTemplate");for(A in this.get("formInputs")){C=h(['*[data-table-view-column="',this.get("formInputs")[A].model.get("name"),'"]'].join(""),D);if(C.length){C.append(this.get("formInputs")[A].$el)}else{D.append(this.get("formInputs")[A].$el)}}}this.model.set("columnFilters",h.fn.ColumnFilters(this.model.get("columnfiltersConfig")));h.extend(B,{mode:this.get("mode")});this.model.set("modalForm",new s(h.extend(B,{bodyContent:D})));this.model.get("columnFilters").on("filters.update",function(E,F){this.trigger("cf.filters.update",E,F);this.$el.trigger("cf.filters.update",[E,F])},this);this.model.get("columnFilters").on("filters.reset",function(E,F){this.trigger("cf.filters.reset",E,F);this.$el.trigger("cf.filters.reset",[E,F])},this);this.model.get("columnFilters").on("columnfilters.ajax.error",function(){this.trigger("datatableview.ajax.error",jqXHR,null);this.$el.trigger("datatableview.ajax.error",[jqXHR,null])},this);this.render()},render:function(){this.$el.append(this.template({}));this.$el.prepend(this.model.get("columnFilters").$el);this.$el.prepend(this.model.get("modalForm").$el);this.model.set("datatable",h("table.dtview-datatable",this.$el).DataTable(this.model.get("datatableConfig")));this.model.set("fc",new h.fn.dataTable.FixedColumns(this.model.get("datatable")))}});h.fn.DataTableView=function(C){if(this.length<1||!this.is("div")){console.error("no element given to DataTableView");return}if(!_.has(C,"mode")){h.extend(C,{mode:h.fn.DataTableView.defaults.mode})}var z,F,K,D=_.indexOf([h.fn.DataTableView.MODES.DISABLED,h.fn.DataTableView.MODES.READ_ONLY],C.mode)>-1,A=[],y=[],I=[],J=[],E=["boolean","bool","num","number","tinyint","smallint","mediumint","int","bigint","double","float","decimal"],G=0;F=_.findWhere(C.tableData.columns,{data:C.tableData.primaryKeyColumn});if(!F){console.error("a column must be identified by the tableData.primaryKeyColumn value");return}K={container:null,modalForm:null,formTemplate:null,columnFilters:null,columnVisibilityControl:null,datatable:null,rowIndex:-1,editIndexes:[],formInputs:[],formInputsMap:{}};if(h('*[data-table-view-template="form"]',this).length){K.formTemplate=h('*[data-table-view-template="form"]',this).detach()}y.push({data:F.data,title:"",cfexclude:true,render:D?x:C.mode===h.fn.DataTableView.MODES.MODIFY_ONLY?e:w});I.push({targets:0,orderable:false,sortable:false,width:"35px",className:"dtv-action-column"});K.formInputsMap[F.data]=new o(h.extend({required:true},F.control));K.formInputs.push(K.formInputsMap[F.data]);A=_.without(C.tableData.columns,F);J=_.map(_.reject(A,function(N){return _.has(N,"cfexclude")}),function(O){var N={data:O.data,title:O.title};if(_.has(O,"cftype")){_.extend(N,{type:O.cftype})}else{_.extend(N,{type:O.type})}if(_.has(O,"table")){_.extend(N,{table:O.table})}if(_.has(O,"datasource")){_.extend(N,{datasource:O.datasource,displayKey:O.displayKey,valueKey:O.valueKey})}if(_.contains(E,N.type)){h.extend(N,_.omit(O.control,["type","table","datasource","displayKey","valueKey"]))}return N},this);for(G in A){var B=A[G],M={data:B.data,title:B.title,type:h.fn.DataTableView.defaults.DB_TO_DT_TYPES[B.type.toLowerCase()]},L="text-center",H=h.extend(true,{name:B.data,label:B.title},B.control);_.extend(M,(_.has(B,"visible")&&_.isBoolean(B.visible))?{visible:B.visible}:{visible:true});switch(B.type){case"varchar":case"tinytext":L="text-center text-nowrap text-capitalize";break;case"mediumtext":case"text":case"longtext":L="notes-column";break}I.push({targets:G,className:L});if(_.has(B,"render")){_.extend(M,{render:B.render})}else{if(_.contains(["object","reference"],B.type)&&_.has(B,"displayKey")&&_.has(B,"valueKey")){_.extend(M,{displayKey:B.displayKey,valueKey:B.valueKey,render:{_:B.displayKey,sort:B.valueKey}});if(_.has(B,"table")){_.extend(M,{table:B.table})}if(_.has(B,"datasource")){_.extend(M,{datasource:B.datasource})}}else{if(B.type==="date"){if(h.fn.DataTableView.defaults.tableData.timestampDates){_.extend(M,{render:h.fn.DataTableView.timestampCellRender})}}}}y.push(M);if(!_.has(B,"inputExclude")||(_.has(B,"inputExclude")&&!B.inputExclude)){if(_.has(B,"required")&&_.isBoolean(B.required)){H.required=B.required}else{B.required=h.fn.DataTableView.defaults.tableData.requiredDefaultValue}if(D){H.readonly=true}else{if(_.has(B,"readonly")&&_.isBoolean(B.readonly)){H.readonly=B.readonly}else{if(_.has(B,"disabled")&&_.isBoolean(B.disabled)){H.disabled=B.disabled}}}switch(H.type){case"hidden":K.formInputsMap[B.data]=new o(H);break;case"text":case"textarea":K.formInputsMap[B.data]=new j(H);break;case"number":K.formInputsMap[B.data]=new t(H);break;case"toggle":K.formInputsMap[B.data]=new d(H);break;case"timestamp":K.formInputsMap[B.data]=new b(h.extend(H,{timestamp:true}));break;case"datepicker":K.formInputsMap[B.data]=new b(H);break;case"buttonGroup":h.extend(H,{buttons:h.map(B.datasource,function(O,N){return{label:O[B.displayKey],value:O[B.valueKey]}}),valueKey:B.valueKey});K.formInputsMap[B.data]=new n(H);break;case"select":h.extend(H,{options:h.map(B.datasource,function(O,N){return{label:_.isFunction(B.displayKey)?B.displayKey(O):O[B.displayKey],value:O[B.valueKey]}}),valueKey:B.valueKey});K.formInputsMap[B.data]=new u(H);break;case"typeahead":K.formInputsMap[B.data]=new f(h.extend(true,{datasets:{name:H.name,source:B.datasource,displayKey:B.displayKey}},H));break;case"custom":K.formInputsMap[B.data]=new H.controlClass(_.omit(H,["type","controlClass"]));break}if(_.has(K.formInputsMap,B.data)){K.formInputs.push(K.formInputsMap[B.data])}}}z=h("<div />").attr(h.fn.DataTableView.defaults.wrapperAttributes);this.replaceWith(z);h.fn.DataTableView.defaults.container=z;h.fn.DataTableView.defaults.columnfiltersConfig.table=h.fn.DataTableView.defaults.tableData.name;h.fn.DataTableView.defaults.columnfiltersConfig.columns=J;h.fn.DataTableView.defaults=h.extend(true,{el:h.fn.DataTableView.defaults.container},h.fn.DataTableView.defaults,C,K);h.fn.DataTableView.defaults.datatableConfig.columns=y;h.fn.DataTableView.defaults.datatableConfig.columnDefs=I;if(h.fn.DataTableView.defaults.url){h.fn.DataTableView.defaults.datatableConfig.serverSide=true;h.fn.DataTableView.defaults.datatableConfig.ajax={url:h.fn.DataTableView.defaults.url,type:"POST",dataType:"json",contentType:"application/json",data:c,processData:false}}return new v(h.fn.DataTableView.defaults)};h.fn.DataTableView.MODES={DISABLED:0,READ_ONLY:1,MODIFY_ONLY:3,MODIFY:5};h.fn.DataTableView.LAYOUT_ORIENTATION={VERTICAL:0,HORIZONTAL:1};h.fn.DataTableView.ACTION_TYPES={NOTHING:1001001,CREATE:1002001,EDIT:3002001};h.fn.DataTableView.timestampCellRender=function(A,z,y,B){return _.isFinite(A)?new Date(A).toLocaleDateString():""};h.fn.DataTableView.defaults={wrapperAttributes:{"class":"datatableview"},mode:h.fn.DataTableView.MODES.READ_ONLY,DB_TO_DT_TYPES:{varchar:"string",tinytext:"string",mediumtext:"string",text:"string",longtext:"string",tinyint:"num",smallint:"num",mediumint:"num","int":"num",bigint:"num","double":"num","float":"num",decimal:"num",date:"date",datetime:"date",timestamp:"date",reference:"num",object:"num"},url:null,webServiceUrl:null,progressBar:null,actionProgressPanel:null,extraUI:null,tableData:{name:"table","class":"row",label:"table row",primaryKeyColumn:null,columns:[],groups:[],requiredDefaultValue:false,timestampDates:true},columnfiltersConfig:{},datatableConfig:{exteriorController:null,searching:false,scrollX:true,scrollY:"400px",scrollCollapse:true,dom:['<"panel panel-default"','<"panel-heading clearfix"','<"refresh-datatable-btn-container pull-left">',"l",'<"column-visibility-container">','<"add-button-container">','<"custom-ui">',"p",">",">",'tpi<"clearfix">'].join(""),processing:true,serverSide:false,order:[[1,"asc"]],columnDefs:[],columns:[]},modalFormConfig:{}};h.fn.DataTableView.VERSION="1.0.1"})(jQuery);